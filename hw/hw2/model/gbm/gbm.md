gbm with cross-validation
=======================

Setup

```r
## Libs
library(gbm)
```

```
## Loading required package: survival
```

```
## Loading required package: splines
```

```
## Loading required package: lattice
```

```
## Loaded gbm 2.0-8
```

```r
library(cvTools)
```

```
## Loading required package: robustbase
```

```
## Loading required package: methods
```

```
## Attaching package: 'robustbase'
```

```
## The following object is masked from 'package:survival':
## 
## heart
```

```r

## Data
load("../lm/trainC.Rdata")

test <- FALSE
if (test) {
    trainC <- trainC[1:1000, ]
}

rmlspe <- function(y, yHat, includeSE = FALSE) {
    rmspe(log(y + 1), log(yHat + 1), includeSE = includeSE)
}

# Remove date and transform the logical vectors into factors
fixStuff <- function(input) {
    res <- input[, !colnames(input) %in% "date"]
    res$business.categories.BeautySpas <- factor(res$business.categories.BeautySpas)
    res$business.categories.Food <- factor(res$business.categories.Food)
    res$business.categories.Restaurants <- factor(res$business.categories.Restaurants)
    res$business.categories.Shopping <- factor(res$business.categories.Shopping)
    res$business.open <- factor(res$business.open)
    return(res)
}
trainC <- fixStuff(trainC)
validateC <- fixStuff(validateC)
```



Just fit one gbm with 10-fold CV

```r

## Fit gbm
fit.gbm.pois <- gbm(votes.useful ~ ., data = trainC, distribution = "poisson", 
    cv.folds = 10, n.trees = 500)
```

```
## CV: 1 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.8685          1.8818     0.0010    0.0003
##      2        1.8680          1.8812     0.0010    0.0003
##      3        1.8674          1.8807     0.0010    0.0003
##      4        1.8669          1.8802     0.0010    0.0003
##      5        1.8663          1.8796     0.0010    0.0003
##      6        1.8658          1.8791     0.0010    0.0003
##      7        1.8652          1.8786     0.0010    0.0003
##      8        1.8646          1.8780     0.0010    0.0003
##      9        1.8641          1.8775     0.0010    0.0003
##     10        1.8635          1.8770     0.0010    0.0003
##     20        1.8582          1.8719     0.0010    0.0003
##     40        1.8477          1.8618     0.0010    0.0003
##     60        1.8376          1.8522     0.0010    0.0003
##     80        1.8279          1.8429     0.0010    0.0002
##    100        1.8185          1.8340     0.0010    0.0002
##    120        1.8095          1.8254     0.0010    0.0002
##    140        1.8008          1.8171     0.0010    0.0002
##    160        1.7924          1.8091     0.0010    0.0002
##    180        1.7841          1.8012     0.0010    0.0002
##    200        1.7760          1.7935     0.0010    0.0002
##    220        1.7682          1.7859     0.0010    0.0002
##    240        1.7603          1.7783     0.0010    0.0002
##    260        1.7527          1.7710     0.0010    0.0002
##    280        1.7450          1.7636     0.0010    0.0002
##    300        1.7374          1.7562     0.0010    0.0002
##    320        1.7298          1.7488     0.0010    0.0002
##    340        1.7228          1.7420     0.0010    0.0002
##    360        1.7159          1.7354     0.0010    0.0002
##    380        1.7089          1.7287     0.0010    0.0002
##    400        1.7021          1.7221     0.0010    0.0002
##    420        1.6954          1.7155     0.0010    0.0001
##    440        1.6889          1.7093     0.0010    0.0002
##    460        1.6824          1.7030     0.0010    0.0002
##    480        1.6762          1.6970     0.0010    0.0002
##    500        1.6701          1.6912     0.0010    0.0001
## 
## CV: 2 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.8691          1.8763     0.0010    0.0003
##      2        1.8685          1.8758     0.0010    0.0003
##      3        1.8680          1.8752     0.0010    0.0003
##      4        1.8674          1.8747     0.0010    0.0003
##      5        1.8669          1.8741     0.0010    0.0003
##      6        1.8663          1.8736     0.0010    0.0003
##      7        1.8658          1.8730     0.0010    0.0003
##      8        1.8653          1.8725     0.0010    0.0003
##      9        1.8647          1.8720     0.0010    0.0003
##     10        1.8642          1.8714     0.0010    0.0003
##     20        1.8589          1.8661     0.0010    0.0003
##     40        1.8483          1.8555     0.0010    0.0002
##     60        1.8384          1.8455     0.0010    0.0002
##     80        1.8287          1.8358     0.0010    0.0002
##    100        1.8194          1.8265     0.0010    0.0002
##    120        1.8103          1.8173     0.0010    0.0002
##    140        1.8016          1.8085     0.0010    0.0002
##    160        1.7932          1.8001     0.0010    0.0002
##    180        1.7848          1.7917     0.0010    0.0002
##    200        1.7767          1.7837     0.0010    0.0002
##    220        1.7687          1.7758     0.0010    0.0002
##    240        1.7608          1.7679     0.0010    0.0002
##    260        1.7530          1.7602     0.0010    0.0002
##    280        1.7455          1.7528     0.0010    0.0002
##    300        1.7379          1.7454     0.0010    0.0002
##    320        1.7307          1.7382     0.0010    0.0002
##    340        1.7234          1.7311     0.0010    0.0002
##    360        1.7165          1.7242     0.0010    0.0002
##    380        1.7095          1.7173     0.0010    0.0002
##    400        1.7027          1.7107     0.0010    0.0002
##    420        1.6960          1.7041     0.0010    0.0002
##    440        1.6895          1.6977     0.0010    0.0002
##    460        1.6832          1.6915     0.0010    0.0002
##    480        1.6769          1.6854     0.0010    0.0002
##    500        1.6707          1.6794     0.0010    0.0001
## 
## CV: 3 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.8714          1.8555     0.0010    0.0003
##      2        1.8708          1.8549     0.0010    0.0003
##      3        1.8703          1.8544     0.0010    0.0003
##      4        1.8698          1.8538     0.0010    0.0003
##      5        1.8692          1.8533     0.0010    0.0003
##      6        1.8686          1.8527     0.0010    0.0003
##      7        1.8681          1.8521     0.0010    0.0003
##      8        1.8675          1.8516     0.0010    0.0003
##      9        1.8670          1.8510     0.0010    0.0003
##     10        1.8664          1.8504     0.0010    0.0003
##     20        1.8612          1.8451     0.0010    0.0003
##     40        1.8507          1.8344     0.0010    0.0003
##     60        1.8406          1.8242     0.0010    0.0002
##     80        1.8310          1.8145     0.0010    0.0002
##    100        1.8218          1.8051     0.0010    0.0002
##    120        1.8129          1.7961     0.0010    0.0002
##    140        1.8042          1.7872     0.0010    0.0002
##    160        1.7958          1.7787     0.0010    0.0002
##    180        1.7878          1.7706     0.0010    0.0002
##    200        1.7796          1.7623     0.0010    0.0002
##    220        1.7716          1.7544     0.0010    0.0002
##    240        1.7638          1.7465     0.0010    0.0002
##    260        1.7561          1.7388     0.0010    0.0002
##    280        1.7485          1.7313     0.0010    0.0002
##    300        1.7410          1.7237     0.0010    0.0002
##    320        1.7337          1.7165     0.0010    0.0002
##    340        1.7267          1.7094     0.0010    0.0002
##    360        1.7195          1.7023     0.0010    0.0002
##    380        1.7128          1.6955     0.0010    0.0001
##    400        1.7059          1.6887     0.0010    0.0002
##    420        1.6991          1.6819     0.0010    0.0002
##    440        1.6927          1.6755     0.0010    0.0002
##    460        1.6863          1.6691     0.0010    0.0002
##    480        1.6799          1.6628     0.0010    0.0002
##    500        1.6739          1.6568     0.0010    0.0002
## 
## CV: 4 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.8704          1.8647     0.0010    0.0003
##      2        1.8698          1.8642     0.0010    0.0003
##      3        1.8693          1.8636     0.0010    0.0003
##      4        1.8687          1.8630     0.0010    0.0003
##      5        1.8681          1.8625     0.0010    0.0003
##      6        1.8676          1.8619     0.0010    0.0003
##      7        1.8671          1.8614     0.0010    0.0003
##      8        1.8666          1.8608     0.0010    0.0003
##      9        1.8660          1.8603     0.0010    0.0003
##     10        1.8655          1.8598     0.0010    0.0003
##     20        1.8602          1.8544     0.0010    0.0003
##     40        1.8498          1.8438     0.0010    0.0003
##     60        1.8399          1.8337     0.0010    0.0003
##     80        1.8303          1.8240     0.0010    0.0002
##    100        1.8210          1.8145     0.0010    0.0002
##    120        1.8121          1.8054     0.0010    0.0002
##    140        1.8034          1.7966     0.0010    0.0002
##    160        1.7950          1.7881     0.0010    0.0002
##    180        1.7868          1.7797     0.0010    0.0002
##    200        1.7788          1.7715     0.0010    0.0002
##    220        1.7707          1.7634     0.0010    0.0002
##    240        1.7629          1.7554     0.0010    0.0002
##    260        1.7552          1.7476     0.0010    0.0002
##    280        1.7478          1.7401     0.0010    0.0002
##    300        1.7401          1.7323     0.0010    0.0002
##    320        1.7327          1.7248     0.0010    0.0002
##    340        1.7255          1.7176     0.0010    0.0002
##    360        1.7184          1.7104     0.0010    0.0002
##    380        1.7115          1.7034     0.0010    0.0002
##    400        1.7049          1.6967     0.0010    0.0001
##    420        1.6985          1.6903     0.0010    0.0001
##    440        1.6920          1.6837     0.0010    0.0002
##    460        1.6858          1.6774     0.0010    0.0002
##    480        1.6794          1.6709     0.0010    0.0001
##    500        1.6736          1.6650     0.0010    0.0001
## 
## CV: 5 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.8687          1.8806     0.0010    0.0003
##      2        1.8681          1.8800     0.0010    0.0003
##      3        1.8675          1.8795     0.0010    0.0003
##      4        1.8670          1.8790     0.0010    0.0003
##      5        1.8665          1.8784     0.0010    0.0003
##      6        1.8659          1.8779     0.0010    0.0003
##      7        1.8654          1.8774     0.0010    0.0003
##      8        1.8649          1.8768     0.0010    0.0003
##      9        1.8643          1.8763     0.0010    0.0003
##     10        1.8638          1.8758     0.0010    0.0003
##     20        1.8584          1.8705     0.0010    0.0003
##     40        1.8479          1.8601     0.0010    0.0002
##     60        1.8377          1.8501     0.0010    0.0002
##     80        1.8280          1.8405     0.0010    0.0002
##    100        1.8187          1.8314     0.0010    0.0002
##    120        1.8096          1.8224     0.0010    0.0002
##    140        1.8008          1.8138     0.0010    0.0002
##    160        1.7924          1.8055     0.0010    0.0002
##    180        1.7842          1.7975     0.0010    0.0002
##    200        1.7761          1.7894     0.0010    0.0002
##    220        1.7682          1.7815     0.0010    0.0002
##    240        1.7604          1.7737     0.0010    0.0002
##    260        1.7526          1.7657     0.0010    0.0002
##    280        1.7450          1.7581     0.0010    0.0002
##    300        1.7375          1.7505     0.0010    0.0002
##    320        1.7302          1.7431     0.0010    0.0002
##    340        1.7227          1.7356     0.0010    0.0002
##    360        1.7158          1.7285     0.0010    0.0002
##    380        1.7090          1.7217     0.0010    0.0002
##    400        1.7023          1.7150     0.0010    0.0002
##    420        1.6957          1.7084     0.0010    0.0002
##    440        1.6894          1.7021     0.0010    0.0002
##    460        1.6832          1.6959     0.0010    0.0001
##    480        1.6769          1.6896     0.0010    0.0002
##    500        1.6708          1.6835     0.0010    0.0001
## 
## CV: 6 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.8711          1.8584     0.0010    0.0003
##      2        1.8706          1.8578     0.0010    0.0003
##      3        1.8701          1.8573     0.0010    0.0003
##      4        1.8695          1.8567     0.0010    0.0003
##      5        1.8689          1.8561     0.0010    0.0003
##      6        1.8684          1.8556     0.0010    0.0003
##      7        1.8679          1.8550     0.0010    0.0003
##      8        1.8673          1.8545     0.0010    0.0003
##      9        1.8668          1.8539     0.0010    0.0003
##     10        1.8662          1.8533     0.0010    0.0003
##     20        1.8608          1.8478     0.0010    0.0003
##     40        1.8503          1.8370     0.0010    0.0002
##     60        1.8404          1.8268     0.0010    0.0002
##     80        1.8307          1.8168     0.0010    0.0002
##    100        1.8215          1.8072     0.0010    0.0002
##    120        1.8125          1.7979     0.0010    0.0002
##    140        1.8038          1.7888     0.0010    0.0002
##    160        1.7955          1.7801     0.0010    0.0002
##    180        1.7874          1.7717     0.0010    0.0002
##    200        1.7794          1.7633     0.0010    0.0002
##    220        1.7717          1.7551     0.0010    0.0002
##    240        1.7638          1.7468     0.0010    0.0002
##    260        1.7563          1.7389     0.0010    0.0002
##    280        1.7488          1.7309     0.0010    0.0002
##    300        1.7414          1.7231     0.0010    0.0002
##    320        1.7341          1.7153     0.0010    0.0002
##    340        1.7270          1.7077     0.0010    0.0002
##    360        1.7199          1.7002     0.0010    0.0002
##    380        1.7133          1.6932     0.0010    0.0001
##    400        1.7067          1.6862     0.0010    0.0002
##    420        1.7004          1.6794     0.0010    0.0002
##    440        1.6940          1.6726     0.0010    0.0002
##    460        1.6877          1.6658     0.0010    0.0002
##    480        1.6813          1.6590     0.0010    0.0002
##    500        1.6753          1.6526     0.0010    0.0001
## 
## CV: 7 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.8658          1.9064     0.0010    0.0003
##      2        1.8652          1.9059     0.0010    0.0003
##      3        1.8647          1.9054     0.0010    0.0003
##      4        1.8641          1.9049     0.0010    0.0003
##      5        1.8636          1.9043     0.0010    0.0003
##      6        1.8630          1.9038     0.0010    0.0003
##      7        1.8624          1.9033     0.0010    0.0003
##      8        1.8619          1.9028     0.0010    0.0003
##      9        1.8613          1.9023     0.0010    0.0003
##     10        1.8608          1.9018     0.0010    0.0003
##     20        1.8553          1.8968     0.0010    0.0003
##     40        1.8448          1.8871     0.0010    0.0003
##     60        1.8347          1.8778     0.0010    0.0002
##     80        1.8248          1.8687     0.0010    0.0002
##    100        1.8155          1.8602     0.0010    0.0002
##    120        1.8063          1.8518     0.0010    0.0002
##    140        1.7976          1.8439     0.0010    0.0002
##    160        1.7891          1.8362     0.0010    0.0002
##    180        1.7806          1.8286     0.0010    0.0002
##    200        1.7725          1.8212     0.0010    0.0002
##    220        1.7645          1.8140     0.0010    0.0002
##    240        1.7564          1.8069     0.0010    0.0002
##    260        1.7486          1.7999     0.0010    0.0002
##    280        1.7408          1.7929     0.0010    0.0002
##    300        1.7331          1.7861     0.0010    0.0002
##    320        1.7259          1.7797     0.0010    0.0002
##    340        1.7185          1.7731     0.0010    0.0002
##    360        1.7113          1.7668     0.0010    0.0002
##    380        1.7044          1.7606     0.0010    0.0002
##    400        1.6974          1.7544     0.0010    0.0002
##    420        1.6907          1.7485     0.0010    0.0001
##    440        1.6841          1.7428     0.0010    0.0002
##    460        1.6777          1.7370     0.0010    0.0002
##    480        1.6714          1.7314     0.0010    0.0001
##    500        1.6653          1.7260     0.0010    0.0001
## 
## CV: 8 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.8709          1.8598     0.0010    0.0003
##      2        1.8704          1.8593     0.0010    0.0003
##      3        1.8698          1.8588     0.0010    0.0003
##      4        1.8693          1.8582     0.0010    0.0003
##      5        1.8688          1.8577     0.0010    0.0003
##      6        1.8682          1.8572     0.0010    0.0003
##      7        1.8677          1.8567     0.0010    0.0003
##      8        1.8671          1.8561     0.0010    0.0003
##      9        1.8666          1.8556     0.0010    0.0003
##     10        1.8661          1.8551     0.0010    0.0003
##     20        1.8608          1.8499     0.0010    0.0003
##     40        1.8504          1.8397     0.0010    0.0003
##     60        1.8405          1.8301     0.0010    0.0002
##     80        1.8308          1.8206     0.0010    0.0002
##    100        1.8215          1.8115     0.0010    0.0002
##    120        1.8124          1.8026     0.0010    0.0002
##    140        1.8037          1.7941     0.0010    0.0002
##    160        1.7951          1.7857     0.0010    0.0002
##    180        1.7869          1.7776     0.0010    0.0002
##    200        1.7788          1.7698     0.0010    0.0002
##    220        1.7709          1.7620     0.0010    0.0002
##    240        1.7630          1.7543     0.0010    0.0002
##    260        1.7555          1.7470     0.0010    0.0002
##    280        1.7478          1.7394     0.0010    0.0002
##    300        1.7401          1.7319     0.0010    0.0002
##    320        1.7328          1.7247     0.0010    0.0002
##    340        1.7257          1.7177     0.0010    0.0002
##    360        1.7186          1.7107     0.0010    0.0002
##    380        1.7117          1.7039     0.0010    0.0002
##    400        1.7050          1.6973     0.0010    0.0002
##    420        1.6983          1.6908     0.0010    0.0002
##    440        1.6919          1.6846     0.0010    0.0002
##    460        1.6857          1.6785     0.0010    0.0002
##    480        1.6793          1.6722     0.0010    0.0002
##    500        1.6732          1.6662     0.0010    0.0002
## 
## CV: 9 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.8707          1.8622     0.0010    0.0003
##      2        1.8701          1.8616     0.0010    0.0003
##      3        1.8696          1.8611     0.0010    0.0003
##      4        1.8691          1.8605     0.0010    0.0003
##      5        1.8685          1.8599     0.0010    0.0003
##      6        1.8680          1.8594     0.0010    0.0003
##      7        1.8674          1.8588     0.0010    0.0003
##      8        1.8668          1.8582     0.0010    0.0003
##      9        1.8663          1.8576     0.0010    0.0003
##     10        1.8658          1.8571     0.0010    0.0003
##     20        1.8603          1.8514     0.0010    0.0003
##     40        1.8499          1.8405     0.0010    0.0002
##     60        1.8399          1.8300     0.0010    0.0003
##     80        1.8304          1.8199     0.0010    0.0002
##    100        1.8212          1.8103     0.0010    0.0002
##    120        1.8122          1.8008     0.0010    0.0002
##    140        1.8036          1.7918     0.0010    0.0002
##    160        1.7952          1.7829     0.0010    0.0002
##    180        1.7872          1.7744     0.0010    0.0002
##    200        1.7792          1.7659     0.0010    0.0002
##    220        1.7714          1.7576     0.0010    0.0002
##    240        1.7634          1.7492     0.0010    0.0002
##    260        1.7558          1.7411     0.0010    0.0002
##    280        1.7483          1.7332     0.0010    0.0002
##    300        1.7407          1.7251     0.0010    0.0002
##    320        1.7336          1.7175     0.0010    0.0002
##    340        1.7264          1.7099     0.0010    0.0002
##    360        1.7195          1.7025     0.0010    0.0002
##    380        1.7126          1.6952     0.0010    0.0002
##    400        1.7059          1.6881     0.0010    0.0002
##    420        1.6995          1.6812     0.0010    0.0002
##    440        1.6929          1.6742     0.0010    0.0001
##    460        1.6867          1.6677     0.0010    0.0002
##    480        1.6808          1.6613     0.0010    0.0001
##    500        1.6746          1.6547     0.0010    0.0001
## 
## CV: 10 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.8717          1.8535     0.0010    0.0003
##      2        1.8711          1.8530     0.0010    0.0003
##      3        1.8706          1.8525     0.0010    0.0003
##      4        1.8701          1.8519     0.0010    0.0003
##      5        1.8696          1.8514     0.0010    0.0003
##      6        1.8690          1.8508     0.0010    0.0003
##      7        1.8685          1.8503     0.0010    0.0003
##      8        1.8679          1.8497     0.0010    0.0003
##      9        1.8674          1.8492     0.0010    0.0003
##     10        1.8669          1.8487     0.0010    0.0003
##     20        1.8616          1.8432     0.0010    0.0003
##     40        1.8511          1.8325     0.0010    0.0002
##     60        1.8411          1.8223     0.0010    0.0002
##     80        1.8315          1.8125     0.0010    0.0002
##    100        1.8222          1.8029     0.0010    0.0002
##    120        1.8132          1.7938     0.0010    0.0002
##    140        1.8047          1.7850     0.0010    0.0002
##    160        1.7962          1.7763     0.0010    0.0002
##    180        1.7880          1.7680     0.0010    0.0002
##    200        1.7800          1.7597     0.0010    0.0002
##    220        1.7721          1.7516     0.0010    0.0002
##    240        1.7641          1.7434     0.0010    0.0002
##    260        1.7563          1.7355     0.0010    0.0002
##    280        1.7489          1.7279     0.0010    0.0002
##    300        1.7416          1.7204     0.0010    0.0002
##    320        1.7343          1.7129     0.0010    0.0002
##    340        1.7271          1.7055     0.0010    0.0002
##    360        1.7201          1.6983     0.0010    0.0002
##    380        1.7131          1.6911     0.0010    0.0002
##    400        1.7066          1.6845     0.0010    0.0002
##    420        1.7000          1.6778     0.0010    0.0002
##    440        1.6936          1.6713     0.0010    0.0002
##    460        1.6872          1.6648     0.0010    0.0002
##    480        1.6810          1.6585     0.0010    0.0002
##    500        1.6750          1.6524     0.0010    0.0002
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.8699             nan     0.0010    0.0003
##      2        1.8693             nan     0.0010    0.0003
##      3        1.8687             nan     0.0010    0.0003
##      4        1.8682             nan     0.0010    0.0003
##      5        1.8676             nan     0.0010    0.0003
##      6        1.8671             nan     0.0010    0.0003
##      7        1.8665             nan     0.0010    0.0003
##      8        1.8660             nan     0.0010    0.0003
##      9        1.8654             nan     0.0010    0.0003
##     10        1.8649             nan     0.0010    0.0003
##     20        1.8596             nan     0.0010    0.0003
##     40        1.8491             nan     0.0010    0.0003
##     60        1.8390             nan     0.0010    0.0002
##     80        1.8294             nan     0.0010    0.0002
##    100        1.8201             nan     0.0010    0.0002
##    120        1.8110             nan     0.0010    0.0002
##    140        1.8024             nan     0.0010    0.0002
##    160        1.7941             nan     0.0010    0.0002
##    180        1.7859             nan     0.0010    0.0002
##    200        1.7779             nan     0.0010    0.0002
##    220        1.7700             nan     0.0010    0.0002
##    240        1.7621             nan     0.0010    0.0002
##    260        1.7541             nan     0.0010    0.0002
##    280        1.7465             nan     0.0010    0.0002
##    300        1.7390             nan     0.0010    0.0002
##    320        1.7318             nan     0.0010    0.0002
##    340        1.7246             nan     0.0010    0.0002
##    360        1.7178             nan     0.0010    0.0002
##    380        1.7108             nan     0.0010    0.0002
##    400        1.7041             nan     0.0010    0.0002
##    420        1.6975             nan     0.0010    0.0002
##    440        1.6911             nan     0.0010    0.0001
##    460        1.6845             nan     0.0010    0.0002
##    480        1.6782             nan     0.0010    0.0002
##    500        1.6723             nan     0.0010    0.0001
```

```r
# summary(fit.gbm.pois)
pretty.gbm.tree(fit.gbm.pois)
```

```
##   SplitVar SplitCodePred LeftNode RightNode MissingNode ErrorReduction
## 0       52     1.765e+02        1         2           3          30668
## 1       -1    -2.896e-04       -1        -1          -1              0
## 2       -1     6.474e-04       -1        -1          -1              0
## 3       -1    -8.695e-05       -1        -1          -1              0
##   Weight Prediction
## 0  70272 -8.695e-05
## 1  55077 -2.896e-04
## 2  15195  6.474e-04
## 3  70272 -8.695e-05
```

```r
show(fit.gbm.pois)
```

```
## gbm(formula = votes.useful ~ ., distribution = "poisson", data = trainC, 
##     n.trees = 500, cv.folds = 10)
## A gradient boosted model with poisson loss function.
## 500 iterations were performed.
## The best cross-validation iteration was 500.
## There were 65 predictors of which 3 had non-zero influence.
```

```r

## Evaluate with validation data set
pred.pois <- predict(fit.gbm.pois, validateC, type = "response")
```

```
## Using 500 trees...
```

```r
e.gbm.pois <- rmlspe(validateC$votes.useful, pred.pois, includeSE = TRUE)
e.gbm.pois
```

```
## $rmspe
## [1] 0.6545
## 
## $se
## [1] 0.001495
```

```r
summary(pred.pois)
```

```
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    1.20    1.20    1.25    1.35    1.41    1.78
```

```r

save(fit.gbm.pois, e.gbm.pois, file = "gbm.Rdata")
```


Reproducibility

```r
print(proc.time())
```

```
##    user  system elapsed 
## 1667.42   11.73 1680.21
```

```r
sessionInfo()
```

```
## R version 3.0.0 Patched (2013-04-30 r62698)
## Platform: x86_64-unknown-linux-gnu (64-bit)
## 
## locale:
##  [1] LC_CTYPE=en_US.iso885915       LC_NUMERIC=C                  
##  [3] LC_TIME=en_US.iso885915        LC_COLLATE=en_US.iso885915    
##  [5] LC_MONETARY=en_US.iso885915    LC_MESSAGES=en_US.iso885915   
##  [7] LC_PAPER=C                     LC_NAME=C                     
##  [9] LC_ADDRESS=C                   LC_TELEPHONE=C                
## [11] LC_MEASUREMENT=en_US.iso885915 LC_IDENTIFICATION=C           
## 
## attached base packages:
## [1] methods   splines   stats     graphics  grDevices utils     datasets 
## [8] base     
## 
## other attached packages:
## [1] cvTools_0.3.2    robustbase_0.9-7 gbm_2.0-8        lattice_0.20-15 
## [5] survival_2.37-4  knitr_1.2       
## 
## loaded via a namespace (and not attached):
## [1] digest_0.6.3   evaluate_0.4.3 formatR_0.7    grid_3.0.0    
## [5] stringr_0.6.2  tools_3.0.0
```

